<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Git Commit Activity{% if repo_name %} – {{ repo_name }}{% endif %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
      body {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        margin: 1.5rem;
        background-color: #05070a;
        color: #e5e7eb;
      }
      h1 {
        font-size: 1.4rem;
        margin-bottom: 0.5rem;
      }
      h2 {
        margin-top: 0;
        margin-bottom: 0.5rem;
        font-size: 1.1rem;
      }
      a {
        color: #93c5fd;
      }
      .top-row {
        display: flex;
        flex-wrap: wrap;
        align-items: flex-end;
        justify-content: space-between;
        gap: 1rem;
      }
      .repo-line {
        margin: 0.25rem 0 0;
        font-size: 0.9rem;
        color: #9ca3af;
      }
      .repo-form {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        align-items: center;
      }
      .repo-input {
        background-color: #020617;
        border-radius: 9999px;
        border: 1px solid #374151;
        padding: 0.35rem 0.75rem;
        color: #e5e7eb;
        min-width: 260px;
        font-size: 0.85rem;
      }
      .repo-input::placeholder {
        color: #6b7280;
      }
      .repo-button {
        border-radius: 9999px;
        border: none;
        padding: 0.35rem 0.9rem;
        background-color: #3b82f6;
        color: white;
        font-size: 0.85rem;
        cursor: pointer;
      }
      .repo-button:hover {
        background-color: #2563eb;
      }
      .charts-row {
        display: flex;
        flex-wrap: wrap;
        gap: 1rem;
        margin-top: 1rem;
        margin-bottom: 1rem;
      }
      .chart-container {
        background-color: #111827;
        border-radius: 0.75rem;
        padding: 1rem;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.6);
      }
      .chart-half {
        flex: 1 1 0;
        min-width: 320px;
      }
      .summary-row {
        display: flex;
        flex-wrap: nowrap;
        gap: 0.75rem;
        margin-top: 1rem;
        margin-bottom: 0.5rem;
        overflow-x: auto;
        padding-bottom: 0.25rem;
      }
      .stat-card {
        background-color: #111827;
        border-radius: 0.75rem;
        padding: 0.6rem 0.85rem;
        min-width: 140px;
      }
      .stat-label {
        font-size: 0.75rem;
        text-transform: uppercase;
        letter-spacing: 0.06em;
        color: #9ca3af;
      }
      .stat-value {
        font-size: 1.25rem;
        font-weight: 500;
        margin-top: 0.15rem;
      }
      .stat-sub {
        font-size: 0.75rem;
        color: #6b7280;
        margin-top: 0.15rem;
      }
      .tabs {
        display: flex;
        gap: 0.5rem;
        margin-top: 0.75rem;
        border-bottom: 1px solid #111827;
      }
      .tab-button {
        border: none;
        background: transparent;
        color: #9ca3af;
        padding: 0.4rem 0.85rem;
        font-size: 0.9rem;
        cursor: pointer;
        border-bottom: 2px solid transparent;
        border-radius: 0.25rem 0.25rem 0 0;
      }
      .tab-button:hover {
        color: #e5e7eb;
      }
      .tab-button.active {
        color: #e5e7eb;
        border-color: #3b82f6;
        background-color: #020617;
      }
      .tab-content {
        display: none;
        margin-top: 1rem;
      }
      .tab-content.active {
        display: block;
      }
      .range-row {
        display: flex;
        flex-wrap: wrap;
        gap: 0.75rem;
        align-items: center;
        margin-top: 0.5rem;
      }
      .range-label {
        font-size: 0.8rem;
        color: #9ca3af;
        display: flex;
        align-items: center;
        gap: 0.35rem;
      }
      .range-input {
        background-color: #020617;
        border-radius: 9999px;
        border: 1px solid #374151;
        padding: 0.25rem 0.6rem;
        color: #e5e7eb;
        font-size: 0.8rem;
      }
      .range-button {
        border-radius: 9999px;
        border: 1px solid #374151;
        padding: 0.25rem 0.8rem;
        background-color: #020617;
        color: #e5e7eb;
        font-size: 0.8rem;
        cursor: pointer;
      }
      .range-button:hover {
        background-color: #111827;
      }
      .focus-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 1rem;
        margin-bottom: 0.75rem;
      }
      .focus-label {
        font-size: 0.9rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }
      .focus-label select {
        background-color: #020617;
        color: #e5e7eb;
        border-radius: 9999px;
        border: 1px solid #374151;
        padding: 0.25rem 0.75rem;
        font-size: 0.9rem;
      }
      .focus-label select:focus {
        outline: 2px solid #3b82f6;
        outline-offset: 1px;
      }
      .chart-header {
        display: flex;
        align-items: baseline;
        justify-content: space-between;
        gap: 0.5rem;
      }
      .chart-caption {
        font-size: 0.75rem;
        color: #9ca3af;
        margin: 0;
      }
      .focus-summary-row {
        display: flex;
        flex-wrap: wrap;
        gap: 0.75rem;
        margin-bottom: 0.75rem;
      }
      .focus-summary-row .stat-card {
        padding: 0.6rem 0.85rem;
      }
      .focus-charts-row {
        display: flex;
        flex-wrap: wrap;
        gap: 1rem;
      }
      .focus-charts-row .chart-half {
        flex: 1 1 0;
        min-width: 260px;
      }
      .focus-charts-row canvas {
        height: 220px;
      }
      canvas {
        max-width: 100%;
        height: 320px;
      }
    </style>
  </head>
  <body>
    <div class="top-row">
      <div>
        <h1>Commit Activity from Git</h1>
        {% if repo_name %}
        <p class="repo-line">
          Repository:
          {% if repo_url %}
          <a id="repoLink" href="{{ repo_url }}" target="_blank" rel="noreferrer">
            <code>{{ repo_name }}</code>
          </a>
          {% else %}
          <code id="repoName">{{ repo_name }}</code>
          {% endif %}
          (via <code>git log</code>).
        </p>
        {% endif %}
      </div>
      <form id="repoForm" class="repo-form">
        <input
          type="url"
          id="repoInput"
          class="repo-input"
          placeholder="https://github.com/user/repo"
          {% if repo_url %}value="{{ repo_url }}"{% endif %}
          aria-label="GitHub repository URL"
        />
        <button type="submit" class="repo-button">Load repo</button>
      </form>
    </div>

    <div class="summary-row">
      <div class="stat-card">
        <div class="stat-label">Total commits</div>
        <div class="stat-value" id="statTotalCommits">–</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Authors</div>
        <div class="stat-value" id="statAuthors">–</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Commits per author</div>
        <div class="stat-value" id="statCommitsPerAuthor">–</div>
        <div class="stat-sub" id="statCommitsPerAuthorSub"></div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Commits in past 7 days</div>
        <div class="stat-value" id="statCommitsLast7Days">–</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Last commit</div>
        <div class="stat-value" id="statLastCommitAuthor">–</div>
        <div class="stat-sub" id="statLastCommitWhen"></div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Top author</div>
        <div class="stat-value">
          <a id="topAuthor1Name" href="#" target="_blank" rel="noreferrer">–</a>
        </div>
        <div class="stat-sub" id="topAuthor1Commits"></div>
      </div>
      <div class="stat-card">
        <div class="stat-label">2nd author</div>
        <div class="stat-value">
          <a id="topAuthor2Name" href="#" target="_blank" rel="noreferrer">–</a>
        </div>
        <div class="stat-sub" id="topAuthor2Commits"></div>
      </div>
      <div class="stat-card">
        <div class="stat-label">3rd author</div>
        <div class="stat-value">
          <a id="topAuthor3Name" href="#" target="_blank" rel="noreferrer">–</a>
        </div>
        <div class="stat-sub" id="topAuthor3Commits"></div>
      </div>
    </div>

    <div class="tabs">
      <button class="tab-button active" data-tab="overview">Overview</button>
      <button class="tab-button" data-tab="focus">Focus author</button>
    </div>

    <div class="range-row">
      <label class="range-label">
        From
        <input type="date" id="dateRangeStart" class="range-input" />
      </label>
      <label class="range-label">
        To
        <input type="date" id="dateRangeEnd" class="range-input" />
      </label>
      <button type="button" id="dateRangeReset" class="range-button">Reset</button>
    </div>

    <div class="tab-content active" id="tab-overview">
      <div class="charts-row">
        <div class="chart-container chart-half">
          <h2>Total commits per day</h2>
          <canvas id="totalChart"></canvas>
        </div>

        <div class="chart-container chart-half">
          <div class="chart-header">
            <h2>Commits per day by author</h2>
            <p class="chart-caption">Hover over a line to see the author.</p>
          </div>
          <canvas id="authorChart"></canvas>
        </div>
      </div>
    </div>

    <div class="tab-content" id="tab-focus">
      <div class="chart-container">
        <div class="focus-header">
          <h2>Focus author activity</h2>
          <label class="focus-label">
            Focus author
            <select id="focusAuthorSelect">
              <option value="">Select an author…</option>
            </select>
          </label>
        </div>
        <div class="focus-summary-row">
          <div class="stat-card">
            <div class="stat-label">Last commit</div>
            <div class="stat-value" id="focusLastCommit">–</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Total commits</div>
            <div class="stat-value" id="focusTotalCommits">–</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Past 7 days</div>
            <div class="stat-value" id="focusCommitsLast7Days">–</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">This month</div>
            <div class="stat-value" id="focusCommitsThisMonth">–</div>
          </div>
        </div>
        <div class="focus-charts-row">
          <div class="chart-half">
            <canvas id="focusAuthorChart"></canvas>
          </div>
          <div class="chart-half">
            <canvas id="focusAuthorZeroChart"></canvas>
          </div>
        </div>
      </div>
    </div>

    <script src="/static/app.js"></script>
  </body>
</html>
